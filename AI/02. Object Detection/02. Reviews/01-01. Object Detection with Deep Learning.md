# **Object Detection with Deep Learning**

<hr>

```
[1] : Zhao, Z.-Q. Author, Zheng, P., Xu, S.-T.(2019). Object Detection with Deep Learning: A Review. IEEE Transactions on Neural Networks and Learning Systems, 30(11),8627998, pp. 3212-3232.
```



## Object Detection

<hr>

- Object Detection : 주어진 이미지에서 객체가 어디에 있는지(object localization), 각 객체가 속한 범주(object classification) 결정 
  1. Informative region selection
     - 이미지의 어느 위치에나 다른 물체가 나타날 수 있고 가로 세로 비율이나 크기가 다를 수 있음.
     - 멀티 스케일 슬라이딩 윈도우로 전체 이미지 스캔하
     - 후보 창(candidate windows)이 많기 때문에 계산 비용이 많이 들고 중복 창(redundant windows)이 많이 생성됨.
  2. Feature extraction
     - 대표적 특징 : Scale-invariant feature transform(SIFT) , histograms of oriented gradients (HOG) [20] , Haar-like
  3. Classification
     - 대상 객체를 다른 모든 범주와 구별하고 시각적 인식을 위해 표현을 보다 계층적이고 의미있게 만들기 위한 classifier 필요
     - 일반적으로 Supported Vector Machine (SVM), AdaBoost, Deformable Part-based Model (DPM) 이 좋은 성능을 보임.
     - 2012년 이후 앙상블 시스템을 구축하고 약간의 변형을 사용하여 성능을 올림.
       - 슬라이딩 윈도우를 사용하는 bounding box(BB)의 생성이 중복되고 비효율적이며 부정확
       - R-CNN 제안 이후, classification과 BB  회귀 작업을 최적화 하는 Fast R-CNN 제안
       - YOLO(you only look once) : fixed-grid regression을 통해 객체 감지 수행
     - CNN 구조에서 일반적인 객체 감지는 BB 회귀 사용
     - salient object detection은 local contrast enhancement, 픽셀 수준 분할로 수행

- Object Detection 응용 분야

![그림 1.-물체 감지의 응용 영역.](https://ieeexplore.ieee.org/mediastore_new/IEEE/content/media/5962385/8886738/8627998/zhao1-2876865-small.gif)



## CNN architecture

<hr>

- CNN의 각 층은 feature map이라고 함.
- 입력층의 feature map은 서로 다른 색상 채널(e.g. RGB)에 대한 픽셀 강도의 3D 행렬
- internal layer의 feature map은 유도된 멀티 채널 이미지, 픽셀은 특정 기능
- 모든 뉴런은 이전 계층의 인접 뉴런의 small portion에 연결됨.
- 필터링 연산은 뉴런의 receptive filed 값으로 필터 행렬을 컨볼루션하고 sigmoid, ReLu와 같은 비선형 함수를 사용
- 풀링 작업은 receptive filed 응답을 하나의 값으로 요약
  - Pooling operation : max pooling, average pooling, L2-pooling and local contrast normalization
- 컨볼루션과 풀링 사이에 interleave를 사용하면 initial feature hierarchy이 구성됨.
  - 여러 개의 Fully-Connected 층을 추가하여 서로 다른 시각적 작업에 조정 가능
  - 다른 활성화 함수를 가진 최종 레이어 각 출력 뉴런에 대한 특정 조건부 확률을 얻기 위해 추가됨
- 전체 네트워크는 stochastic gradient descent(SGD)를 통해 목적함수(평균제곱오차(MSE) or 교차 엔트로피 손실)을 통해 최적화

- The advantages of CNN
  - Hierarchical feature representation을 데이터로부터 자동 학습
  - 입력 데이터의 hidden factor는 다단계 비선형 매핑을 통해 분리될 수 있음.

![A CNN that sees an image of a car and outputs a class.](https://cezannec.github.io/assets/cnn_intro/CNN_ex.png)



## Generic object detection architectures

<hr>

- 하나의 이미지에서 기존 객체를 찾아 분류(classifying)하고 직사각형 바운딩박스로 레이블을 지정하여 confidences of existence 표시

- 객체 감지 프레임워크

  - Region Proposal Based Framework

    1. 기존의 객체 감지 파이프라인을 따라, region proposals를 생성 후 각 제안을 서로 다른 객체 카테고리로 분류
       - R-CNN, SPP-net, Fast R-CNN, Faster R-CNN, R-FCN, FPN, Mask R-CNN 
    2. 영역 제안 기반 프레임워크 : 전체 시나리오 스캔 후 regions of interest(ROI)에 초점을 맞춤
       - 대표적으로 Overfeat 모델은 CNN을 슬라이딩 윈도우 방법에 삽입하여 객체 카테고리의 신뢰도를 얻은 후 최상위 feature map의 위치에서 직접 BB 예측

    - **R-CNN**

      - 순서
        1. Region proposal generation
           - selective search를 채택하여 각 이미지에 대해 약 2,000개의 region proposals 생성
             - selective search : 임의의 크기보다 정확한 candidate box를 제공 및 객체 감지에서 검색 공간 감소
        2. CNN based deep feature extraction
           - 각 region proposal은 고정된 해상도로 뒤틀리거나 잘림.
           - 높은 수준의 의미론적 feature 확보
        3. Classification and localization
           - 여러 클래스에 대해 사전 훈련된 카테고리별 linear SVM을 사용하여 긍정/부정 영역에 대한 점수 매김
           - 각 영역은 bounding box regression와 탐욕적 non-maximum suppression(NMS)로 필터되어 보존된 객체 위치에 최종 BB 생성

      ![img](https://ieeexplore.ieee.org/mediastore_new/IEEE/content/media/5962385/8886738/8627998/zhao3-2876865-large.gif)

      - The disadvantages of R-CNN
        1. FC 레이어의 존재로 인해 고정된 크기의 입력 이미지의 평가 영역에 대한 CNN의 재 계산으로 많은 시간 소요
        2. R-CNN의 훈련은 다단계 파이프 라인임.
           - 객체 제안에 대한 ConvNet 미세 조정, 소프트맥스가 SVM으로 대체, 경계 상자 회귀자 훈련
        3. 선택적 검색은 상대적으로 high recall region proposal을 생성하지만, 기존의 proposal은 여전히 중복

    - **SPP-Net**

      - R-CNN의 FC 층은 고정된 크기를 입력 받아야 하므로, 이 과정에서 잘린 영역에 개체가 존재하거나 뒤틀림으로 인해 왜곡이 발생할 수 있다는 문제 개선을 위해 spatial pyramid matching(SPM) 이론을 고려하여 새로운 구조 제안
      - 5번째 conv 층의 feature map을 재 사용하여 임의 크기의 영역 제안을 고정 길이 feature vector에 투영
      - 서로 다른 region proposal을 올바르게 추정하여 더 나은 결과 확보 및 spatial pyramid pooling layer(최종 전환 층의 다음 층, SPP) 계층 이전에 계산 비용을 공유하여 테스트 기간의 감지 효율성 향상

      ![img](https://ieeexplore.ieee.org/mediastore_new/IEEE/content/media/5962385/8886738/8627998/zhao4-2876865-large.gif)

  

  - Regression/Classification Based Framework
    - MultiBox, AttentionNet, G-CNN, YOLO, SSD, YOLOv2, DSSD, DSOD

  

